<openerp>

    <!-- ******************* updating groups ******************-->
    <menuitem id="hr_payroll.menu_hr_payroll_configuration" name="Configuración"
              parent="hr_payroll.menu_hr_payroll_root" sequence="100"
              groups="hr_payroll.group_hr_payroll_user,hr_payroll.group_hr_payroll_manager"/>
    <menuitem id="hr_payroll.menu_department_tree" action="hr_payroll.action_view_hr_payslip_form"
              parent="hr_payroll.menu_hr_payroll_root"
              groups="hr_payroll.group_hr_payroll_user,hr_payroll.group_hr_payroll_manager"/>

    <!-- ************************* qweb *********************** -->
    <template id="report_payslip_custom" inherit_id="hr_payroll.report_payslip">
        <!--<xpath expr="//div[@class='header']" position="replace">
            <div class ="header">
                Your Code
            </div>
        </xpath>-->
        <xpath expr="//div[@class='page']" position="replace">
            <div class="page">
                <h2>Nómina</h2>
                <p t-field="o.name"/>

                <div>
                <table class="table table-condensed table-bordered">
                    <tr>
                        <td colspan="2"><strong>Referencia</strong></td>
                        <td colspan="2"><span t-field="o.number"/></td>
                    </tr>
                </table>
                <table class="table table-condensed table-bordered">
                    <tr>
                        <td><strong>Nombre</strong></td>
                        <td><span t-field="o.employee_id"/></td>
                        <td><strong>Periodo</strong></td>
                        <td><span t-field="o.date_from" t-field-options="{'format': 'MM-yy'}"/></td>
                    </tr>
                    <tr>
                        <td><strong>DPI/PASS</strong></td>
                        <td><span t-field="o.employee_id.identification_id"/> /
                            <span t-field="o.employee_id.passport_id"/></td>
                        <td rowspan="2"><strong>Periodo de pago</strong></td>
                        <td rowspan="2"><span t-field="o.date_from" t-field-options="{'format': 'dd'}"/> al
                            <span t-field="o.date_to" t-field-options="{'format': 'dd MMMM yy'}"/></td>
                    </tr>
                    <tr>
                        <td><strong>Nit</strong></td>
                        <td><span t-field="o.employee_id.x_nit"/></td>
                    </tr>
                    <tr>
                        <td><strong>Puesto</strong></td>
                        <td><span t-field="o.employee_id.job_id"/></td>
                        <td><strong>Sueldo ordinario</strong></td>
                        <td><span t-esc="o.contract_id.wage"
                                  t-esc-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}'/></td>
                    </tr>
                    <tr>
                        <td><strong>Departamento</strong></td>
                        <td><span t-field="o.employee_id.department_id"/></td>
                        <td><strong>Forma de pago</strong></td>
                        <td>Depósito en banco</td>
                    </tr>
                </table>
            </div>

                <table class="table table-condensed">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Descripción</th>
                            <th>Monto</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr t-foreach="o.line_ids.filtered(lambda line: line.appears_on_payslip)" t-as="line">
                            <td><span t-field="line.code"/></td>
                            <td><span t-field="line.name"/></td>
                            <td><span t-field="line.amount"/></td>
                            <td><span t-field="line.total"/></td>

                        </tr>
                    </tbody>
                </table>

                <table class="table table-condensed table-bordered">
                    <tr>
                        <td><strong>Firma de recibido</strong></td>
                        <td style="min-width:200px"></td>
                        <td><strong>Fecha</strong></td>
                        <td style="min-width:100px"></td>
                    </tr>
                </table>

                <table class="table table-condensed table-bordered">
                    <tr>
                        <td>* La presente constituye constancia de retención de impuesto sobre la renta del trabajo,
                            según reglamento de impuesto sobre la renta. Acuerdo Gubernativo No. 213-2013.</td>
                    </tr>
                </table>
            </div>
        </xpath>
    </template>

    <!-- ******************* updating views ******************-->
    <!-- Widget reporte departamentos - nuevo campo -->
    <record id="view_hr_payslip_form_updated" model="ir.ui.view">
        <field name="model">hr.payslip</field>
        <field name="inherit_id" ref="hr_payroll.view_hr_payslip_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='worked_days_line_ids']" position="replace">
                <field name="worked_days_line_ids">
                    <tree string="Worked Days" editable="bottom">
                        <field name="name"/>
                        <field name="code"/>
                        <field name="number_of_days" sum="Total Working Days"/>
                        <field name="number_of_hours"/>
                        <field name="number_of_days_calendar"/>
                        <field name="contract_id"/>
                        <field name="sequence" invisible="True"/>
                    </tree>
                    <form string="Worked Day">
                        <group col="4">
                            <field name="name"/>
                            <field name="code"/>
                            <field name="sequence"/>
                            <field name="number_of_days"/>
                            <field name="number_of_hours"/>
                            <field name="number_of_days_calendar"/>
                            <field name="contract_id"/>
                        </group>
                    </form>
                </field>
            </xpath>
        </field>
    </record>

</openerp>